# BCC: Execve Syscall vs Pid statistics

## Question
Write a BCC program that attaches to the execve() system call and prints the pid and the number of times it has called the syscall. (note how BCC handles all the steps performed in Task 1). Note that you need to first install Python bindings for this task. Hence, import and use the python BCC package

**Expected Deliverable:** A single file with your code. Your code must contain an inlined PROG section and BPF( ) call. You can use the perf tool to verify your output


## Solution

Command invocation invocation
```shellscript
$ sudo python execv-monitor.py
```

Example invocation:
```shellscript
$ sudo python execv-monitor.py 
Profiling execve... Hit Ctrl-C to end.
^C
b'xdg-mime'          1885890 1
b'xdg-mime'          1886072 1
b'sh'                1885484 1
b'Sandbox Forked'    1885941 1
b'xdg-mime'          1885898 1
b'firefox'           1885607 1
b'xdg-settings'      1885764 1
b'cpuUsage.sh'       1885954 1
b'code'              1885738 1
b'xdg-settings'      1885766 1
b'firefox'           1885592 1
b'snap'              1885509 1
b'desktop-launch'    1885548 1
b'desktop-launch'    1885552 1
b'snap'              1885872 1
b'xdg-mime'          1885900 1
b'xdg-mime'          1885793 1
b'desktop-launch'    1885568 1
b'xdg-settings'      1885870 1
b'code'              1886080 4
b'xdg-mime'          1885887 1
b'xdg-settings'      1886060 1
b'cpuUsage.sh'       1885488 1
b'xdg-mime'          1885893 1
b'cpuUsage.sh'       1885956 1
b'xdg-mime'          1886074 1
b'xdg-settings'      1885871 1
b'xdg-mime'          1886064 1
b'xdg-settings'      1886055 1
b'cpuUsage.sh'       1885505 1
b'code'              1885740 1
b'desktop-launch'    1885574 1
b'code'              1885483 1
b'xdg-settings'      1885768 1
b'xdg-settings'      1886047 1
b'xdg-settings'      1885771 1
b'firefox'           1885762 8
b'sh'                1885742 1
b'Sandbox Forked'    1885669 1
b'desktop-launch'    1885588 1
b'code'              1885491 4
b'desktop-launch'    1885545 1
b'desktop-launch'    1885553 1
b'xdg-mime'          1885901 1
b'xdg-mime'          1886075 1
b'cpuUsage.sh'       1885950 1
b'xdg-mime'          1885780 1
b'(imedated)'        1885671 1
b'xdg-mime'          1885794 1
b'cpuUsage.sh'       1885486 1
b'xdg-mime'          1885791 1
b'desktop-launch'    1885570 1
b'xdg-mime'          1885783 1
b'firefox.launche'   1885509 1
b'xdg-settings'      1886057 1
b'xdg-settings'      1886058 1
b'snap-confine'      1885509 1
b'desktop-launch'    1885544 1
b'sh'                1885746 1
b'firefox'           1885597 1
b'gnome-shell'       1885509 1
b'cpuUsage.sh'       1885487 1
b'xdg-settings'      1885883 1
b'xdg-settings'      1886054 1
b'xdg-settings'      1885776 1
b'xdg-mime'          1886061 1
b'Sandbox Forked'    1885911 1
b'snap-exec'         1885509 1
b'sh'                1885739 1
b'Sandbox Forked'    1886008 1
b'sh'                1885480 1
b'desktop-launch'    1885563 1
b'desktop-launch'    1885575 1
b'xdg-mime'          1886078 1
b'pool-/usr/libex'   1885677 4
b'code'              1885975 4
b'firefox'           1885509 1
b'desktop-launch'    1885577 1
b'IPC Launch'        1885905 1
b'desktop-launch'    1885587 1
b'snap'              1885677 1
b'xdg-mime'          1885777 1
b'xdg-settings'      1885773 1
b'cpuUsage.sh'       1885752 1
b'snap'              1885765 1
b'code'              1885753 4
b'desktop-launch'    1885564 1
b'cpuUsage.sh'       1885507 1
b'Sandbox Forked'    1885812 1
b'cpuUsage.sh'       1885952 1
b'cpuUsage.sh'       1885490 1
b'cpuUsage.sh'       1885500 1
b'xdg-mime'          1885895 1
b'xdg-settings'      1885875 1
b'desktop-launch'    1885509 1
b'desktop-launch'    1885583 1
b'desktop-launch'    1885567 1
b'xdg-mime'          1885785 1
b'xdg-settings'      1885881 1
b'xdg-mime'          1886067 1
b'xdg-settings'      1885878 1
b'desktop-launch'    1885579 1
b'code'              1885481 1
b'xdg-settings'      1885877 1
b'snap'              1885522 1
b'env'               1885509 1
b'sh'                1885482 1
b'cpuUsage.sh'       1885503 1
b'Sandbox Forked'    1886034 1
b'code'              1885745 1
b'desktop-launch'    1885547 1
b'Sandbox Forked'    1885928 1
b'cpuUsage.sh'       1885485 1
b'xdg-mime'          1886077 1
b'xdg-settings'      1886048 1
b'xdg-mime'          1885788 1
b'xdg-mime'          1885790 1
b'cpuUsage.sh'       1885748 1
b'cpuUsage.sh'       1885501 1
b'desktop-launch'    1885551 1
b'desktop-launch'    1885558 1
b'desktop-launch'    1885572 1
b'cpuUsage.sh'       1885750 1
b'xdg-settings'      1885880 1
b'snap'              1886049 1
b'Sandbox Forked'    1885704 1
b'firefox'           1885869 8
b'gio-launch-desk'   1885509 1
b'xdg-settings'      1885763 1
b'firefox'           1886046 8
b'desktop-launch'    1885585 1
b'cpuUsage.sh'       1885751 1
b'desktop-launch'    1885550 1
b'desktop-launch'    1885565 1
b'code'              1885479 1
b'xdg-mime'          1885884 1
b'xdg-settings'      1885770 1
b'desktop-launch'    1885580 1
b'cpuUsage.sh'       1885749 1
b'desktop-launch'    1885586 1
b'xdg-mime'          1885897 1
b'xdg-mime'          1885892 1
b'desktop-launch'    1885582 1
b'xdg-settings'      1886052 1
b'xdg-mime'          1886070 1
b'xdg-settings'      1885774 1
b'xdg-mime'          1886069 1
b'cpuUsage.sh'       1885949 1
b'xdg-settings'      1886050 1
b'xdg-mime'          1885786 1
b'code'              1885635 4
b'desktop-launch'    1885589 1
b'cpuUsage.sh'       1885747 1
b'cpuUsage.sh'       1885489 1
b'xdg-settings'      1885873 1
```

## Test code

A test code to iterate through the ```/proc/<pid>``` entries is added to count file descriptor in ```fdinfo``` and invoke bpftrace script too and validate input

```shellscript
$ sudo python3 testcode.py
```
